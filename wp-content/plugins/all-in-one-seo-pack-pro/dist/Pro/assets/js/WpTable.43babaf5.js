import{b as f,d as _,c,m as u}from"./vuex.esm-bundler.f966fce5.js";import{C as v}from"./index.f123d27f.js";import{C as b}from"./Index.c0b708e6.js";import{_ as $,q as g,j as p,k as o,o as m,x as r,t as d,b as w,z as A}from"./_plugin-vue_export-helper.299eda55.js";import{u as T}from"./helpers.73050afe.js";import{R as U}from"./RequiresUpdate.fe231e49.js";import{c as L}from"./postContent.42ceb47d.js";import{C as y}from"./Index.60834494.js";import{S as k}from"./Caret.e5d23aaa.js";const P={emits:["addon-activated"],components:{CoreAlert:v,Cta:b},props:{addonSlug:{type:String,required:!0},featureList:{type:Array,default:()=>[]},postActivationPromises:{type:Array,default:()=>[]},ctaButtonText:String,ctaHeader:String,ctaDescription:String,learnMoreText:String,learnMoreLink:String,alignTop:Boolean},data(){return{strings:{activateError:this.$t.__("An error occurred while activating the addon. Please upload it manually or contact support for more information.",this.$td),permissionWarning:this.$t.__("You currently don't have permission to activate this addon. Please ask a site administrator to activate first.",this.$td)},failed:!1,activationLoading:!1}},methods:{...f(["installPlugins"]),..._(["updateAddon"]),activateAddon(){this.failed=!1,this.activationLoading=!0;const t=this.$addons.getAddon(this.addonSlug);this.installPlugins([{plugin:t.basename}]).then(e=>{if(e.body.failed.length){this.activationLoading=!1,this.failed=!0;return}const s=this.postActivationPromises.map(a=>a());Promise.all(s).then(()=>{this.activationLoading=!1,t.hasMinimumVersion=!0,t.isActive=!0,this.updateAddon(t),this.$emit("addon-activated",t)})}).catch(()=>{this.activationLoading=!1})}}};function C(t,e,s,a,i,h){const l=g("core-alert"),n=g("cta");return m(),p(n,{"cta-button-visible":t.$addons.userCanInstallOrActivate(s.addonSlug),"cta-button-visible-warning":i.strings.permissionWarning,"cta-link":`${t.$aioseo.urls.aio.featureManager}&aioseo-activate=${s.addonSlug}`,"cta-button-action":"","cta-button-loading":i.activationLoading,onCtaButtonClick:h.activateAddon,"same-tab":"","button-text":s.ctaButtonText,"learn-more-link":s.learnMoreLink,"feature-list":s.featureList,"align-top":s.alignTop},{"header-text":o(()=>[r(d(s.ctaHeader),1)]),description:o(()=>[i.failed?(m(),p(l,{key:0,type:"red"},{default:o(()=>[r(d(i.strings.activateError),1)]),_:1})):w("",!0),r(" "+d(s.ctaDescription),1)]),"learn-more-text":o(()=>[r(d(s.learnMoreText),1)]),_:1},8,["cta-button-visible","cta-button-visible-warning","cta-link","cta-button-loading","onCtaButtonClick","button-text","learn-more-link","feature-list","align-top"])}const x=$(P,[["render",C]]),B={emits:["addon-activated"],components:{CoreAlert:v,Cta:b},props:{addonSlug:{type:String,required:!0},featureList:{type:Array,default:()=>[]},postActivationPromises:{type:Array,default:()=>[]},addonName:String,installedVersion:String,minimumVersion:String,ctaButtonText:String,ctaHeader:String,ctaDescription:String,learnMoreText:String,learnMoreLink:String,alignTop:Boolean},data(){return{strings:{activateError:this.$t.__("An error occurred while activating the addon. Please upload it manually or contact support for more information.",this.$td),permissionWarning:this.$t.__("You currently don't have permission to activate this addon. Please ask a site administrator to activate first.",this.$td),updateRequired:this.$t.sprintf(this.$t.__("This addon requires an update. %1$s %2$s requires a minimum version of %3$s for the %4$s addon. You currently have %5$s installed.",this.$td),"AIOSEO","Pro",this.$addons.getAddon(this.addonSlug).installedVersion,this.$addons.getAddon(this.addonSlug).name,this.$addons.getAddon(this.addonSlug).installedVersion)},failed:!1,activationLoading:!1}},methods:{...f(["upgradePlugins"]),..._(["updateAddon"]),upgradeAddon(){this.failed=!1,this.activationLoading=!0;const t=this.$addons.getAddon(this.addonSlug);this.upgradePlugins([{plugin:t.sku}]).then(e=>{if(e.body.failed.length){this.activationLoading=!1,this.failed=!0;return}const s=this.postActivationPromises.map(a=>a());Promise.all(s).then(()=>{const a=e.body.completed[t.sku];this.activationLoading=!1,t.hasMinimumVersion=!0,t.isActive=!0,t.installedVersion=a.installedVersion,this.updateAddon(t),this.$emit("addon-activated",t)})}).catch(()=>{this.activationLoading=!1})}}};function I(t,e,s,a,i,h){const l=g("core-alert"),n=g("cta");return m(),p(n,{"cta-button-visible":t.$addons.userCanUpdate(s.addonSlug),"cta-button-visible-warning":i.strings.permissionWarning,"cta-link":`${t.$aioseo.urls.aio.featureManager}&aioseo-activate=${s.addonSlug}`,"cta-button-action":"","cta-button-loading":i.activationLoading,onCtaButtonClick:h.upgradeAddon,"same-tab":"","button-text":s.ctaButtonText,"learn-more-link":s.learnMoreLink,"feature-list":s.featureList,"align-top":s.alignTop},{"header-text":o(()=>[r(d(s.ctaHeader),1)]),description:o(()=>[A(l,{type:"yellow"},{default:o(()=>[r(d(i.strings.updateRequired),1)]),_:1}),i.failed?(m(),p(l,{key:0,type:"red"},{default:o(()=>[r(d(i.strings.activateError),1)]),_:1})):w("",!0),r(" "+d(s.ctaDescription),1)]),"learn-more-text":o(()=>[r(d(s.learnMoreText),1)]),_:1},8,["cta-button-visible","cta-button-visible-warning","cta-link","cta-button-loading","onCtaButtonClick","button-text","learn-more-link","feature-list","align-top"])}const R=$(B,[["render",I]]),O={computed:{...c(["isUnlicensed"]),ctaComponent(){return this.shouldShowUpdate?R:x},shouldShowMain(){return!this.isUnlicensed&&this.$addons.isActive(this.addonSlug)&&!this.$addons.requiresUpgrade(this.addonSlug)&&this.$addons.hasMinimumVersion(this.addonSlug)},shouldShowActivate(){return!this.isUnlicensed&&!this.$addons.isActive(this.addonSlug)&&this.$addons.canActivate(this.addonSlug)&&!this.$addons.requiresUpgrade(this.addonSlug)&&(this.$addons.hasMinimumVersion(this.addonSlug)||!this.$addons.isInstalled(this.addonSlug))},shouldShowUpdate(){return!this.isUnlicensed&&this.$addons.isInstalled(this.addonSlug)&&!this.$addons.requiresUpgrade(this.addonSlug)&&!this.$addons.hasMinimumVersion(this.addonSlug)},shouldShowLite(){return this.isUnlicensed||this.$addons.requiresUpgrade(this.addonSlug)}}},H={computed:{...c(["isUnlicensed"]),shouldShowLite(){return this.isUnlicensed}},methods:{shouldShowMain(t,e){return!this.isUnlicensed&&this.$license.hasCoreFeature(this.$aioseo,t,e)},shouldShowUpgrade(t,e){return!this.isUnlicensed&&!this.$license.hasCoreFeature(this.$aioseo,t,e)}}},Z={computed:{...u(["networkData"]),getSites(){return JSON.parse(JSON.stringify(this.networkData.sites.sites))},getSitesIds(){return Array.from(this.getSites,t=>this.getUniqueSiteId(t))},inactiveSitesIds(){return T(this.getSitesIds,this.activeSitesIds)},activeSitesIds(){const t=[];return this.getSites.forEach(e=>{this.networkData.activeSites.some(s=>s.domain===e.domain&&s.path===e.path)&&t.push(this.getUniqueSiteId(e))}),t}},methods:{getUniqueSiteId(t){return`${t.blog_id}_${t.domain}_${t.path}`},getMainSite(){let t=null;return this.getSites.forEach(e=>{this.isMainSite(e.domain,e.path)&&(t=e)}),t},isMainSite(t,e){return(this.$aioseo.urls.mainSiteUrl+"/").includes(`${this.$aioseo.data.isSsl?"https":"http"}://${t}${e}`)},getSiteByDomainAndPath(t,e){return this.getSites.find(s=>s.domain===t&&s.path===e)},getSiteByUniqueId(t){return this.getSites.find(e=>this.getUniqueSiteId(e)===t)},getActiveSiteByUniqueId(t){const e=this.getSiteByUniqueId(t);return e?this.networkData.activeSites.find(s=>s.domain===e.domain&&s.path===e.path):null},isSiteActive(t){return this.activeSitesIds.includes(this.getUniqueSiteId(t))},parseSiteValue(t){const e=[];return t.forEach(s=>{e.push(this.getSiteByUniqueId(s))}),e}}},Y={computed:{...c(["activeNotifications","activeNotificationsCount","dismissedNotifications","dismissedNotificationsCount"]),notificationsCount(){return this.dismissed?this.dismissedNotificationsCount:this.activeNotificationsCount},notifications(){return this.dismissed?this.dismissedNotifications:this.activeNotifications},notificationTitle(){return this.dismissed?this.strings.notifications:this.strings.newNotifications}},methods:{..._(["toggleDismissedNotifications","toggleNotifications"])}},j={computed:{...c(["isUnlicensed"])},methods:{getExcludedUpdateTabs(t){if(!this.isUnlicensed&&this.$addons.hasMinimumVersion(t)&&!this.$addons.requiresUpgrade(t))return[];const e=[];return this.$router.options.routes.forEach(s=>{if(!s.meta||!s.meta.middleware)return;(Array.isArray(s.meta.middleware)?s.meta.middleware:[s.meta.middleware]).some(i=>i===U)&&e.push(s.name)}),e}}},J={computed:{...u(["currentPost","tags"]),...u("live-tags",["liveTags"])},methods:{parseTags(t){return!t||!this.tags.tags?t:(this.tags.tags.forEach(e=>{if(e.id==="custom_field"){const n=new RegExp(`#${e.id}-([a-zA-Z0-9_-]+)`),S=t.match(n);S&&S[1]&&(t=t.replace(n,L(S[1])));return}if(e.id==="tax_name"){const n=new RegExp(`#${e.id}-([a-zA-Z0-9_-]+)`,"g");t=t.replace(n,`[${e.name} - $1]`);return}const s=new RegExp(`#${e.id}(?![a-zA-Z0-9_])`,"g");e.id==="separator_sa"&&this.separator!==void 0&&(t=t.replace(s,this.separator));const a=t.match(s),i=this.liveTags[e.id]||e.value;a&&(t=t.replace(s,"%|%"+i)),e.value=i;const{tags:h}=window.aioseo.tags,l=h.find(n=>n.id===e.id);l&&(l.value=i)}),t=t.replace(/%\|%/g,""),this.$tags.decodeHTMLEntities(this.$tags.decodeHTMLEntities(t.replace(/<(?:.|\n)*?>/gm," ").replace(/\s/g," "))))}}},G={computed:{...c(["isUnlicensed"]),toolsSettings(){const t=[{value:"webmasterTools",label:this.$t.__("Webmaster Tools",this.$td),access:"aioseo_general_settings"},{value:"rssContent",label:this.$t.__("RSS Content",this.$td),access:"aioseo_general_settings"},{value:"advanced",label:this.$t.__("Advanced",this.$td),access:"aioseo_general_settings"},{value:"searchAppearance",label:this.$t.__("Search Appearance",this.$td),access:"aioseo_search_appearance_settings"},{value:"social",label:this.$t.__("Social Networks",this.$td),access:"aioseo_social_networks_settings"},{value:"sitemap",label:this.$t.__("Sitemaps",this.$td),access:"aioseo_sitemap_settings"},{value:"robots",label:this.$t.__("Robots.txt",this.$td),access:"aioseo_tools_settings"},{value:"breadcrumbs",label:this.$t.__("Breadcrumbs",this.$td),access:"aioseo_general_settings"}];return window.aioseo.internalOptions.internal.deprecatedOptions.includes("badBotBlocker")&&t.push({value:"blocker",label:this.$t.__("Bad Bot Blocker",this.$td),access:"aioseo_tools_settings"}),this.$isPro&&t.push({value:"accessControl",label:this.$t.__("Access Control",this.$td),access:"aioseo_admin"}),!this.isUnlicensed&&this.showImageSeoReset&&t.push({value:"image",label:this.$t.__("Image SEO",this.$td),access:"aioseo_search_appearance_settings"}),!this.isUnlicensed&&this.showLocalBusinessReset&&t.push({value:"localBusiness",label:this.$t.__("Local Business SEO",this.$td),access:"aioseo_local_seo_settings"}),!this.isUnlicensed&&this.showRedirectsReset&&t.push({value:"redirects",label:this.$t.__("Redirects",this.$td),access:"aioseo_redirects_settings"}),!this.isUnlicensed&&this.showLinkAssistantReset&&t.push({value:"linkAssistant",label:this.$t.__("Link Assistant",this.$td),access:"aioseo_link_assistant_settings"}),t.filter(e=>this.$allowed(e.access))},showImageSeoReset(){const t=this.$addons.getAddon("aioseo-image-seo");return t&&t.isActive&&!t.requiresUpgrade},showLocalBusinessReset(){const t=this.$addons.getAddon("aioseo-local-business");return t&&t.isActive&&!t.requiresUpgrade},showRedirectsReset(){const t=this.$addons.getAddon("aioseo-redirects");return t&&t.isActive&&!t.requiresUpgrade},showLinkAssistantReset(){const t=this.$addons.getAddon("aioseo-link-assistant");return t&&t.isActive&&!t.requiresUpgrade}}},K={computed:{...c("wizard",["getNextLink","getPrevLink"]),...c(["isUnlicensed"]),features(){return[...this.$constants.WIZARD_FEATURES]},getSelectedUpsellFeatures(){return this.presetFeatures?this.presetFeatures.filter(t=>this.needsUpsell(this.features.find(e=>e.value===t))).map(t=>this.features.find(e=>e.value===t)):[]}},methods:{..._("wizard",["setCurrentStage"]),needsUpsell(t){return t.pro?!!(this.isUnlicensed||t.upgrade&&this.$addons.requiresUpgrade(t.upgrade)):!1}},mounted(){this.setCurrentStage(this.stage)}},Q={components:{CoreModal:y,SvgClose:k},data(){return{loading:!1,showModal:!1}},computed:{...u("wizard",["smartRecommendations"])},methods:{...f("wizard",["saveWizard"]),processOptIn(){this.smartRecommendations.usageTracking=!0,this.loading=!0,this.saveWizard("smartRecommendations").then(()=>{window.location.href=this.$aioseo.urls.aio.dashboard})}}},X={data(){return{resultsPerPage:20,orderBy:null,orderDir:"asc",searchTerm:"",pageNumber:1,filter:"all",wpTableKey:0,wpTableLoading:!1}},methods:{...f(["changeItemsPerPage"]),refreshTable(){return this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1)},processAdditionalFilters({filters:t}){this.wpTableLoading=!0,this.processFetchTableData(t).then(()=>this.wpTableLoading=!1)},processSearch(t){typeof t=="object"&&(t=t.target.value),this.pageNumber=1,this.searchTerm=t,this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1)},processPagination(t){this.pageNumber=t,this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1)},processFilterTable(t){this.filter=t.slug,this.searchTerm="",this.pageNumber=1,this.wpTableLoading=!0,this.resetSelectedFilters(),this.processFetchTableData().then(()=>this.wpTableLoading=!1)},processChangeItemsPerPage(t){this.pageNumber=1,this.resultsPerPage=t,this.wpTableLoading=!0,this.changeItemsPerPage({slug:this.changeItemsPerPageSlug,value:t}).then(()=>this.processFetchTableData().then(()=>this.$scrollTo(`#${this.tableId}`,{offset:-110}))).then(()=>this.wpTableLoading=!1)},processSort(t,e){e.target.blur(),this.orderBy=t.slug,this.orderDir=this.orderBy!==t.slug?t.sortDir:t.sortDir==="asc"?"desc":"asc",this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1)},processFetchTableData(t){return this.fetchData({slug:this.slug||null,orderBy:this.orderBy,orderDir:this.orderDir,limit:this.resultsPerPage,offset:this.pageNumber===1?0:(this.pageNumber-1)*this.resultsPerPage,searchTerm:this.searchTerm,filter:this.filter,additionalFilters:t||this.selectedFilters})},resetSelectedFilters(){}},created(){this.resultsPerPage=this.$aioseo.settings.tablePagination[this.changeItemsPerPageSlug]||this.resultsPerPage}};export{O as A,H as L,Z as N,j as R,J as T,K as W,Q as a,X as b,G as c,Y as d};
